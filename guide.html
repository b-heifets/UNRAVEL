
<!DOCTYPE html>


<html lang="en" data-content_root="./" data-theme="dark">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Guide &#8212; UNRAVEL docs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "dark";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "dark";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=872d93e8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=8d563738"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="https://unpkg.com/mermaid@10.2.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'guide';</script>
    <link rel="icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="unravel package" href="unravel/toc.html" />
    <link rel="prev" title="Installation" href="installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="dark">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">UNRAVEL docs</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="unravel/toc.html">
    unravel package
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/b-heifets/UNRAVEL" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="unravel/toc.html">
    unravel package
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/b-heifets/UNRAVEL" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Guide</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="guide">
<h1>Guide<a class="headerlink" href="#guide" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>If you are unfamiliar with the terminal, please review these <a class="reference external" href="https://andysbrainbook.readthedocs.io/en/latest/index.html">command line tutorials</a>.</p></li>
</ul>
<hr class="docutils" />
<section id="typical-workflow">
<h2>Typical workflow<a class="headerlink" href="#typical-workflow" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Each nodes shows a description of the step and related commands.</p></li>
</ul>
<div class="mermaid">
            flowchart TD
    A(((LSFM))) --&gt; B[3D autofluo image]
    B --&gt; C(Registration: reg_prep, seg_copy_tifs, seg_brain_mask, reg, reg_check) 
    A --&gt; D[3D immunofluo image]
    D --&gt; F(Remove autofluo + warp IF image to atlas space: vstats_prep)
    C --&gt; F
    F --&gt; G(Z-score: vstats_z_score)
    G --&gt; N(Aggregate images: utils_agg_files)
    N --&gt; H(Smoothing + average left and right sides: vstats_whole_to_avg)
    H --&gt; J(Voxel-wise stats: vstats)
    J --&gt; K(FDR correction of p value maps: cluster_fdr_range, cluster_fdr, cluster_mirror_indices)
    K --&gt; L(Warp clusters of significant voxels to tissue space + validate clusters with cell/label density measurements: cluster_validation, cluster_summary)
    C --&gt; L
    D --&gt; M(Segment features of interest: seg_copy_tifs, seg_ilastik)
    M --&gt; L
        </div></section>
<hr class="docutils" />
<section id="help-on-commands">
<h2>Help on commands<a class="headerlink" href="#help-on-commands" title="Link to this heading">#</a></h2>
<p>For help/info on a command, run this in the terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&lt;command&gt;<span class="w"> </span>-h
</pre></div>
</div>
<div class="hint dropdown admonition">
<p class="admonition-title">Syntax</p>
<ul class="simple">
<li><p>The symbols &lt; and &gt; indicate placeholders. Replace &lt;command&gt; with the actual command name you want to learn more about.</p></li>
<li><p>Square brackets [ ] in command syntax signify optional elements.</p></li>
<li><p>Double backticks are used in help guides to indicate a command. (e.g., ``command``)</p></li>
</ul>
</div>
<p>To view help on arguments for each script (a.k.a. module) in the online documentation, go to the page for that module, scroll to the parse_args() function, and click the link for viewing the source code.</p>
</section>
<hr class="docutils" />
<section id="listing-commands">
<h2>Listing commands<a class="headerlink" href="#listing-commands" title="Link to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># List common commands and their descriptions</span>
unravel_commands<span class="w"> </span>-c<span class="w"> </span>-d

<span class="c1"># List all commands and their descriptions</span>
unravel_commands<span class="w"> </span>-d<span class="w"> </span>

<span class="c1"># List the modules run by each command</span>
unravel_commands<span class="w"> </span>-m
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<ul class="simple">
<li><p><strong>Prefixes</strong> group together related commands. Use <strong>tab completion</strong> in the terminal to quickly view and access sets of commands within each group.</p></li>
</ul>
</div>
</section>
<hr class="docutils" />
<section id="common-commands">
<h2>Common commands<a class="headerlink" href="#common-commands" title="Link to this heading">#</a></h2>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-0">
Registration</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/register/reg_prep.html#unravel-register-reg-prep"><span class="std std-ref"><strong>reg_prep</strong></span></a>: Prepare registration (resample the autofluo image to lower res).</p></li>
<li><p><a class="reference internal" href="unravel/register/reg.html#unravel-register-reg"><span class="std std-ref"><strong>reg</strong></span></a>: Perform registration (e.g., register the autofluo image to an average template).</p></li>
<li><p><a class="reference internal" href="unravel/register/reg_check.html#unravel-register-reg-check"><span class="std std-ref"><strong>reg_check</strong></span></a>: Check registration (aggregate the autofluo and warped atlas images).</p></li>
</ul>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-1">
Warping</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/warp/to_atlas.html#unravel-warp-to-atlas"><span class="std std-ref"><strong>warp_to_atlas</strong></span></a>: Warp images to atlas space.</p></li>
<li><p><a class="reference internal" href="unravel/warp/to_native.html#unravel-warp-to-native"><span class="std std-ref"><strong>warp_to_native</strong></span></a>: Warp images to native img space, unpad, and scale to full res.</p></li>
</ul>
</div>
<input id="sd-tab-item-2" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-2">
Segmentation</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/segment/copy_tifs.html#unravel-segment-copy-tifs"><span class="std std-ref"><strong>seg_copy_tifs</strong></span></a>: Copy TIF images (copy select tifs to target dir for training ilastik).</p></li>
<li><p><a class="reference internal" href="unravel/segment/brain_mask.html#unravel-segment-brain-mask"><span class="std std-ref"><strong>seg_brain_mask</strong></span></a>: Create brain mask (segment resampled autofluo tifs).</p></li>
<li><p><a class="reference internal" href="unravel/segment/ilastik_pixel_classification.html#unravel-segment-ilastik-pixel-classification"><span class="std std-ref"><strong>seg_ilastik</strong></span></a>: Perform pixel classification w/ Ilastik to segment features of interest.</p></li>
</ul>
</div>
<input id="sd-tab-item-3" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-3">
Voxel-wise stats</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/voxel_stats/vstats_prep.html#unravel-voxel-stats-vstats-prep"><span class="std std-ref"><strong>vstats_prep</strong></span></a>: Prepare immunofluo images for voxel statistics (e.g., background subtract and warp to atlas space).</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/z_score.html#unravel-voxel-stats-z-score"><span class="std std-ref"><strong>vstats_z_score</strong></span></a>: Z-score images.</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/whole_to_LR_avg.html#unravel-voxel-stats-whole-to-lr-avg"><span class="std std-ref"><strong>vstats_whole_to_avg</strong></span></a>: Average left and right hemispheres together.</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/vstats.html#unravel-voxel-stats-vstats"><span class="std std-ref"><strong>vstats</strong></span></a>: Compute voxel statistics.</p></li>
</ul>
</div>
<input id="sd-tab-item-4" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-4">
Cluster-wise stats</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/cluster_stats/fdr_range.html#unravel-cluster-stats-fdr-range"><span class="std std-ref"><strong>cluster_fdr_range</strong></span></a>: Get FDR q value range yielding clusters.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/fdr.html#unravel-cluster-stats-fdr"><span class="std std-ref"><strong>cluster_fdr</strong></span></a>: FDR-correct 1-p value map → cluster map.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/recursively_mirror_rev_cluster_indices.html#unravel-cluster-stats-recursively-mirror-rev-cluster-indices"><span class="std std-ref"><strong>cluster_mirror_indices</strong></span></a>: Recursively mirror cluster maps for validating clusters in left and right hemispheres.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/cluster_validation.html#unravel-cluster-stats-cluster-validation"><span class="std std-ref"><strong>cluster_validation</strong></span></a>: Validate clusters w/ cell/label density measurements.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/cluster_summary.html#unravel-cluster-stats-cluster-summary"><span class="std std-ref"><strong>cluster_summary</strong></span></a>: Summarize info on valid clusters (run after cluster_validation).</p></li>
</ul>
</div>
<input id="sd-tab-item-5" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-5">
Region-wise stats</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/region_stats/rstats.html#unravel-region-stats-rstats"><span class="std std-ref"><strong>rstats</strong></span></a>: Compute regional cell counts, regional volumes, or regional cell densities.</p></li>
<li><p><a class="reference internal" href="unravel/region_stats/rstats_summary.html#unravel-region-stats-rstats-summary"><span class="std std-ref"><strong>rstats_summary</strong></span></a>: Summarize regional cell densities.</p></li>
</ul>
</div>
<input id="sd-tab-item-6" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-6">
Image I/O</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/image_io/metadata.html#unravel-image-io-metadata"><span class="std std-ref"><strong>io_metadata</strong></span></a>: Handle image metadata.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/nii_info.html#unravel-image-io-nii-info"><span class="std std-ref"><strong>io_nii_info</strong></span></a>: Print info about NIfTI files.</p></li>
</ul>
</div>
<input id="sd-tab-item-7" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-7">
Image tools</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/image_tools/avg.html#unravel-image-tools-avg"><span class="std std-ref"><strong>img_avg</strong></span></a>: Average NIfTI images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/unique_intensities.html#unravel-image-tools-unique-intensities"><span class="std std-ref"><strong>img_unique</strong></span></a>: Find unique intensities in images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/max.html#unravel-image-tools-max"><span class="std std-ref"><strong>img_max</strong></span></a>: Print the max intensity value in an image.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/spatial_averaging.html#unravel-image-tools-spatial-averaging"><span class="std std-ref"><strong>img_spatial_avg</strong></span></a>: Perform spatial averaging on images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/rb.html#unravel-image-tools-rb"><span class="std std-ref"><strong>img_rb</strong></span></a>: Apply rolling ball filter to TIF images.</p></li>
</ul>
</div>
<input id="sd-tab-item-8" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" for="sd-tab-item-8">
Utilities</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/utilities/aggregate_files_from_sample_dirs.html#unravel-utilities-aggregate-files-from-sample-dirs"><span class="std std-ref"><strong>utils_agg_files</strong></span></a>: Aggregate files from sample directories.</p></li>
<li><p><a class="reference internal" href="unravel/utilities/prepend_conditions.html#unravel-utilities-prepend-conditions"><span class="std std-ref"><strong>utils_prepend</strong></span></a>: Prepend conditions to files using sample_key.csv.</p></li>
<li><p><a class="reference internal" href="unravel/utilities/rename.html#unravel-utilities-rename"><span class="std std-ref"><strong>utils_rename</strong></span></a>: Rename files.</p></li>
</ul>
</div>
</div>
<div class="note dropdown admonition">
<p class="admonition-title">All commands</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-9" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-9">
Registration</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/register/reg_prep.html#unravel-register-reg-prep"><span class="std std-ref"><strong>reg_prep</strong></span></a>: Prepare registration (resample the autofluo image to lower res).</p></li>
<li><p><a class="reference internal" href="unravel/register/reg.html#unravel-register-reg"><span class="std std-ref"><strong>reg</strong></span></a>: Perform registration (e.g., register the autofluo image to an average template).</p></li>
<li><p><a class="reference internal" href="unravel/register/affine_initializer.html#unravel-register-affine-initializer"><span class="std std-ref"><strong>reg_affine_initializer</strong></span></a>: Part of reg. Roughly aligns the template to the autofl image.</p></li>
<li><p><a class="reference internal" href="unravel/register/reg_check.html#unravel-register-reg-check"><span class="std std-ref"><strong>reg_check</strong></span></a>: Check registration (aggregate the autofluo and warped atlas images).</p></li>
<li><p><a class="reference internal" href="unravel/register/reg_check_brain_mask.html#unravel-register-reg-check-brain-mask"><span class="std std-ref"><strong>reg_check_brain_mask</strong></span></a>: Check brain mask for over/under segmentation.</p></li>
</ul>
</div>
<input id="sd-tab-item-10" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-10">
Warping</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/warp/to_atlas.html#unravel-warp-to-atlas"><span class="std std-ref"><strong>warp_to_atlas</strong></span></a>: Warp images to atlas space.</p></li>
<li><p><a class="reference internal" href="unravel/warp/to_fixed.html#unravel-warp-to-fixed"><span class="std std-ref"><strong>warp_to_fixed</strong></span></a>: Warp images to fixed img space and unpad.</p></li>
<li><p><a class="reference internal" href="unravel/warp/to_native.html#unravel-warp-to-native"><span class="std std-ref"><strong>warp_to_native</strong></span></a>: Warp images to native img space, unpad, and scale to full res.</p></li>
<li><p><a class="reference internal" href="unravel/warp/warp.html#unravel-warp-warp"><span class="std std-ref"><strong>warp</strong></span></a>: Warp between moving and fixed images (these have 15% padding from reg)</p></li>
</ul>
</div>
<input id="sd-tab-item-11" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-11">
Segmentation</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/segment/copy_tifs.html#unravel-segment-copy-tifs"><span class="std std-ref"><strong>seg_copy_tifs</strong></span></a>: Copy TIF images (copy select tifs to target dir for training ilastik).</p></li>
<li><p><a class="reference internal" href="unravel/segment/brain_mask.html#unravel-segment-brain-mask"><span class="std std-ref"><strong>seg_brain_mask</strong></span></a>: Create brain mask (segment resampled autofluo tifs).</p></li>
<li><p><a class="reference internal" href="unravel/segment/ilastik_pixel_classification.html#unravel-segment-ilastik-pixel-classification"><span class="std std-ref"><strong>seg_ilastik</strong></span></a>: Perform pixel classification w/ Ilastik to segment features of interest.</p></li>
<li><p><a class="reference internal" href="unravel/segment/labels_to_masks.html#unravel-segment-labels-to-masks"><span class="std std-ref"><strong>seg_labels_to_masks</strong></span></a>: Convert each label to a binary .nii.gz.</p></li>
</ul>
</div>
<input id="sd-tab-item-12" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-12">
Voxel-wise stats</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/voxel_stats/apply_mask.html#unravel-voxel-stats-apply-mask"><span class="std std-ref"><strong>vstats_apply_mask</strong></span></a>: Apply mask to image (e.g., nullify artifacts or isolate signals).</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/vstats_prep.html#unravel-voxel-stats-vstats-prep"><span class="std std-ref"><strong>vstats_prep</strong></span></a>: Prepare immunofluo images for voxel statistics (e.g., background subtract and warp to atlas space).</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/z_score.html#unravel-voxel-stats-z-score"><span class="std std-ref"><strong>vstats_z_score</strong></span></a>: Z-score images.</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/whole_to_LR_avg.html#unravel-voxel-stats-whole-to-lr-avg"><span class="std std-ref"><strong>vstats_whole_to_avg</strong></span></a>: Average left and right hemispheres together.</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/hemi_to_LR_avg.html#unravel-voxel-stats-hemi-to-lr-avg"><span class="std std-ref"><strong>vstats_hemi_to_avg</strong></span></a>: If left and right hemispheres were processed separately (less common), average them together.</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/vstats.html#unravel-voxel-stats-vstats"><span class="std std-ref"><strong>vstats</strong></span></a>: Compute voxel statistics.</p></li>
<li><p><a class="reference internal" href="unravel/voxel_stats/mirror.html#unravel-voxel-stats-mirror"><span class="std std-ref"><strong>vstats_mirror</strong></span></a>: Flip and optionally shift content of images in atlas space.</p></li>
</ul>
</div>
<input id="sd-tab-item-13" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-13">
Cluster-wise stats</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/cluster_stats/fdr_range.html#unravel-cluster-stats-fdr-range"><span class="std std-ref"><strong>cluster_fdr_range</strong></span></a>: Get FDR q value range yielding clusters.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/fdr.html#unravel-cluster-stats-fdr"><span class="std std-ref"><strong>cluster_fdr</strong></span></a>: FDR-correct 1-p value map → cluster map.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/recursively_mirror_rev_cluster_indices.html#unravel-cluster-stats-recursively-mirror-rev-cluster-indices"><span class="std std-ref"><strong>cluster_mirror_indices</strong></span></a>: Recursively mirror cluster maps for validating clusters in left and right hemispheres.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/cluster_validation.html#unravel-cluster-stats-cluster-validation"><span class="std std-ref"><strong>cluster_validation</strong></span></a>: Validate clusters w/ cell/label density measurements.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/cluster_summary.html#unravel-cluster-stats-cluster-summary"><span class="std std-ref"><strong>cluster_summary</strong></span></a>: Summarize info on valid clusters (run after cluster_validation).</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/org_data.html#unravel-cluster-stats-org-data"><span class="std std-ref"><strong>cluster_org_data</strong></span></a>: Organize CSVs from cluster_validation.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/group_bilateral_data.html#unravel-cluster-stats-group-bilateral-data"><span class="std std-ref"><strong>cluster_group_data</strong></span></a>: Group bilateral cluster data.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/stats.html#unravel-cluster-stats-stats"><span class="std std-ref"><strong>cluster_stats</strong></span></a>: Compute cluster validation statistics.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/mean_IF.html#unravel-cluster-stats-index"><span class="std std-ref"><strong>cluster_index</strong></span></a>: Make a valid cluster map and sunburst plots.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/brain_model.html#unravel-cluster-stats-brain-model"><span class="std std-ref"><strong>cluster_brain_model</strong></span></a>: Make a 3D brain model from a cluster map (for DSI studio).</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/table.html#unravel-cluster-stats-table"><span class="std std-ref"><strong>cluster_table</strong></span></a>: Create a table of cluster validation data.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/prism.html#unravel-cluster-stats-prism"><span class="std std-ref"><strong>cluster_prism</strong></span></a>: Generate CSVs for bar charts in Prism.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/legend.html#unravel-cluster-stats-legend"><span class="std std-ref"><strong>cluster_legend</strong></span></a>: Make a legend of regions in cluster maps.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/sunburst.html#unravel-cluster-stats-sunburst"><span class="std std-ref"><strong>cluster_sunburst</strong></span></a>: Create a sunburst plot of regional volumes.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/find_incongruent_clusters.html#unravel-cluster-stats-find-incongruent-clusters"><span class="std std-ref"><strong>cluster_find_incongruent_clusters</strong></span></a>: Find clusters where the effect direction does not match the prediction of cluster_fdr (for validation of non-directional p value maps).</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/crop.html#unravel-cluster-stats-crop"><span class="std std-ref"><strong>cluster_crop</strong></span></a>: Crop clusters to a bounding box.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/index.html#unravel-cluster-stats-mean-if"><span class="std std-ref"><strong>cluster_mean_IF</strong></span></a>: Compute mean immunofluo intensities for each cluster.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/mean_IF_summary.html#unravel-cluster-stats-mean-if-summary"><span class="std std-ref"><strong>cluster_mean_IF_summary</strong></span></a>: Plot mean immunofluo intensities for each cluster.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/effect_sizes/effect_sizes.html#unravel-cluster-stats-effect-sizes-effect-sizes"><span class="std std-ref"><strong>effect_sizes</strong></span></a>: Calculate effect sizes for clusters.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/effect_sizes/effect_sizes_by_sex__absolute.html#unravel-cluster-stats-effect-sizes-effect-sizes-by-sex-absolute"><span class="std std-ref"><strong>effect_sizes_sex_abs</strong></span></a>: Calculate absolute effect sizes by sex.</p></li>
<li><p><a class="reference internal" href="unravel/cluster_stats/effect_sizes/effect_sizes_by_sex__relative.html#unravel-cluster-stats-effect-sizes-effect-sizes-by-sex-relative"><span class="std std-ref"><strong>effect_sizes_sex_rel</strong></span></a>: Calculate relative effect sizes by sex.</p></li>
</ul>
</div>
<input id="sd-tab-item-14" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-14">
Region-wise stats</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/region_stats/rstats.html#unravel-region-stats-rstats"><span class="std std-ref"><strong>rstats</strong></span></a>: Compute regional cell counts, regional volumes, or regional cell densities.</p></li>
<li><p><a class="reference internal" href="unravel/region_stats/rstats_summary.html#unravel-region-stats-rstats-summary"><span class="std std-ref"><strong>rstats_summary</strong></span></a>: Summarize regional cell densities.</p></li>
<li><p><a class="reference internal" href="unravel/region_stats/rstats_mean_IF.html#unravel-region-stats-rstats-mean-if"><span class="std std-ref"><strong>rstats_mean_IF</strong></span></a>: Compute mean immunofluo intensities for regions.</p></li>
<li><p><a class="reference internal" href="unravel/region_stats/rstats_mean_IF_in_segmented_voxels.html#unravel-region-stats-rstats-mean-if-in-segmented-voxels"><span class="std std-ref"><strong>rstats_mean_IF_in_seg</strong></span></a>: Compute mean immunofluo intensities in segmented voxels.</p></li>
<li><p><a class="reference internal" href="unravel/region_stats/rstats_mean_IF_summary.html#unravel-region-stats-rstats-mean-if-summary"><span class="std std-ref"><strong>rstats_mean_IF_summary</strong></span></a>: Plot mean immunofluo intensities for regions.</p></li>
</ul>
</div>
<input id="sd-tab-item-15" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-15">
Image I/O</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/image_io/metadata.html#unravel-image-io-metadata"><span class="std std-ref"><strong>io_metadata</strong></span></a>: Handle image metadata.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/io_img.html#unravel-image-io-io-img"><span class="std std-ref"><strong>io_img</strong></span></a>: Image I/O operations.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/nii_info.html#unravel-image-io-nii-info"><span class="std std-ref"><strong>io_nii_info</strong></span></a>: Print info about NIfTI files.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/nii_hd.html#unravel-image-io-nii-hd"><span class="std std-ref"><strong>io_nii_hd</strong></span></a>: Print NIfTI headers.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/io_nii.html#unravel-image-io-io-nii"><span class="std std-ref"><strong>io_nii</strong></span></a>: NIfTI I/O operations (binarize, convert data type, scale, etc).</p></li>
<li><p><a class="reference internal" href="unravel/image_io/reorient_nii.html#unravel-image-io-reorient-nii"><span class="std std-ref"><strong>io_reorient_nii</strong></span></a>: Reorient NIfTI files.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/nii_to_tifs.html#unravel-image-io-nii-to-tifs"><span class="std std-ref"><strong>io_nii_to_tifs</strong></span></a>: Convert NIfTI files to TIFFs.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/nii_to_zarr.html#unravel-image-io-nii-to-zarr"><span class="std std-ref"><strong>io_nii_to_zarr</strong></span></a>: Convert NIfTI files to Zarr.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/zarr_to_nii.html#unravel-image-io-zarr-to-nii"><span class="std std-ref"><strong>io_zarr_to_nii</strong></span></a>: Convert Zarr format to NIfTI.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/h5_to_tifs.html#unravel-image-io-h5-to-tifs"><span class="std std-ref"><strong>io_h5_to_tifs</strong></span></a>: Convert H5 files to TIFFs.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/tif_to_tifs.html#unravel-image-io-tif-to-tifs"><span class="std std-ref"><strong>io_tif_to_tifs</strong></span></a>: Convert TIF to TIFF series.</p></li>
<li><p><a class="reference internal" href="unravel/image_io/img_to_npy.html#unravel-image-io-img-to-npy"><span class="std std-ref"><strong>io_img_to_npy</strong></span></a>: Convert images to Numpy arrays.</p></li>
</ul>
</div>
<input id="sd-tab-item-16" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-16">
Image tools</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/image_tools/avg.html#unravel-image-tools-avg"><span class="std std-ref"><strong>img_avg</strong></span></a>: Average NIfTI images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/unique_intensities.html#unravel-image-tools-unique-intensities"><span class="std std-ref"><strong>img_unique</strong></span></a>: Find unique intensities in images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/max.html#unravel-image-tools-max"><span class="std std-ref"><strong>img_max</strong></span></a>: Print the max intensity value in an image.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/bbox.html#unravel-image-tools-bbox"><span class="std std-ref"><strong>img_bbox</strong></span></a>: Compute bounding box of non-zero voxels in an image.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/spatial_averaging.html#unravel-image-tools-spatial-averaging"><span class="std std-ref"><strong>img_spatial_avg</strong></span></a>: Perform spatial averaging on images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/rb.html#unravel-image-tools-rb"><span class="std std-ref"><strong>img_rb</strong></span></a>: Apply rolling ball filter to TIF images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/DoG.html#unravel-image-tools-dog"><span class="std std-ref"><strong>img_DoG</strong></span></a>: Apply Difference of Gaussian filter to TIF images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/pad.html#unravel-image-tools-pad"><span class="std std-ref"><strong>img_pad</strong></span></a>: Pad images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/resample.html#unravel-image-tools-resample"><span class="std std-ref"><strong>img_resample</strong></span></a>: Resample images.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/extend.html#unravel-image-tools-extend"><span class="std std-ref"><strong>img_extend</strong></span></a>: Extend images (add padding to one side).</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/transpose_axes.html#unravel-image-tools-transpose-axes"><span class="std std-ref"><strong>img_transpose</strong></span></a>: Transpose image axes.</p></li>
</ul>
</div>
<input id="sd-tab-item-17" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-17">
Atlas tools</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/image_tools/atlas/relabel_nii.html#unravel-image-tools-atlas-relabel-nii"><span class="std std-ref"><strong>atlas_relabel</strong></span></a>: Relabel atlas IDs.</p></li>
<li><p><a class="reference internal" href="unravel/image_tools/atlas/wireframe.html#unravel-image-tools-atlas-wireframe"><span class="std std-ref"><strong>atlas_wireframe</strong></span></a>: Make an atlas wireframe.</p></li>
</ul>
</div>
<input id="sd-tab-item-18" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" for="sd-tab-item-18">
Utilities</label><div class="sd-tab-content docutils">
<ul class="simple">
<li><p><a class="reference internal" href="unravel/utilities/aggregate_files_from_sample_dirs.html#unravel-utilities-aggregate-files-from-sample-dirs"><span class="std std-ref"><strong>utils_agg_files</strong></span></a>: Aggregate files from sample directories.</p></li>
<li><p><a class="reference internal" href="unravel/utilities/aggregate_files_recursively.html#unravel-utilities-aggregate-files-recursively"><span class="std std-ref"><strong>utils_agg_files_rec</strong></span></a>: Recursively aggregate files.</p></li>
<li><p><a class="reference internal" href="unravel/utilities/prepend_conditions.html#unravel-utilities-prepend-conditions"><span class="std std-ref"><strong>utils_prepend</strong></span></a>: Prepend conditions to files using sample_key.csv.</p></li>
<li><p><a class="reference internal" href="unravel/utilities/rename.html#unravel-utilities-rename"><span class="std std-ref"><strong>utils_rename</strong></span></a>: Rename files.</p></li>
<li><p><a class="reference internal" href="unravel/utilities/toggle_samples.html#unravel-utilities-toggle-samples"><span class="std std-ref"><strong>utils_toggle</strong></span></a>: Toggle sample?? folders for select batch processing.</p></li>
<li><p><a class="reference internal" href="unravel/utilities/clean_tif_dirs.html#unravel-utilities-clean-tif-dirs"><span class="std std-ref"><strong>utils_clean_tifs</strong></span></a>: Clean TIF directories (no spaces, move non-tifs).</p></li>
</ul>
</div>
</div>
</div>
<div class="note dropdown admonition">
<p class="admonition-title">More info on commands</p>
<p>unravel_commands runs ./&lt;repo_root_dir&gt;/unravel/unravel_commands.py</p>
<p>Its help guide is here: <a class="reference internal" href="unravel/unravel_commands.html#module-unravel.unravel_commands" title="unravel.unravel_commands"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.unravel_commands</span></code></a></p>
<p>Commands are defined in the <code class="docutils literal notranslate"><span class="pre">[project.scripts]</span></code> section of the <a class="reference external" href="https://github.com/b-heifets/UNRAVEL/blob/main/pyproject.toml">pyproject.toml</a> in the root directory of the UNRAVEL repository (repo).</p>
<p>If new commands are added to run new scripts (a.k.a. modules), reinstall the unravel package with pip.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;path<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>root<span class="w"> </span>directory<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>UNRAVEL<span class="w"> </span>repo&gt;
pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="set-up">
<h2>Set up<a class="headerlink" href="#set-up" title="Link to this heading">#</a></h2>
<p>Recommended steps to set up for analysis:</p>
<section id="back-up-raw-data">
<h3>Back up raw data<a class="headerlink" href="#back-up-raw-data" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>For Heifets lab members, we keep one copy of raw data on an external drive and another on a remote server (Dan and Austen have access)</p></li>
</ul>
</section>
<section id="stitch-z-stacks">
<h3>Stitch z-stacks<a class="headerlink" href="#stitch-z-stacks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>We use <a class="reference external" href="https://www.micro-shop.zeiss.com/en/us/softwarefinder/software-categories/zen-blue/">ZEN (blue edition)</a> since we have a <a class="reference external" href="https://www.zeiss.com/microscopy/en/products/light-microscopes/light-sheet-microscopes/lightsheet-7.html">Zeiss Lightsheet 7</a></p></li>
</ul>
<div class="note dropdown admonition">
<p class="admonition-title">Batch stitching settings</p>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="_images/batch_stitching_1.JPG"><img alt="Batch stitching settings" src="_images/batch_stitching_1.JPG" style="height: 500px;" />
</a>
<figcaption>
<p><span class="caption-text">Select a mid-stack reference slice. Ideally, tissue will be present in each tile of the reference slice.</span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
</div>
<div class="note dropdown admonition">
<p class="admonition-title">Running batch stitching</p>
<figure class="align-center">
<img alt="Batch stitching settings" src="_images/batch_stitching_2.JPG" />
</figure>
<ul class="simple">
<li><p>Drag and drop images to be stitched into this section.</p></li>
<li><p>For each image in the list, apply the stitching settings one by one (do not go back to a prior image, as settings will no longer stick).</p></li>
<li><p>Select all images (control + A or shift and click)</p></li>
<li><p>Click “Check All”</p></li>
<li><p>Click “Run Selected”</p></li>
</ul>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Open source options for stitching</p>
<ul class="simple">
<li><p><a class="reference external" href="https://abria.github.io/TeraStitcher/">TeraStitcher</a></p></li>
<li><p><a class="reference external" href="https://github.com/lens-biophotonics/ZetaStitcher">ZetaStitched</a></p></li>
</ul>
</div>
</section>
<section id="make-sample-folders">
<h3>Make sample folders<a class="headerlink" href="#make-sample-folders" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Make a folder named after each condition in the experiment folder(s)</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>. # This root level folder is referred to as the experiment directory (exp dir) 
├── Control
└── Treatment
</pre></div>
</div>
<ul class="simple">
<li><p>Make sample folders in the directories named after each condition</p></li>
</ul>
<div class="tip dropdown admonition">
<p class="admonition-title">Name sample folders like sample01, sample02, …</p>
<p>This makes batch processing easy.</p>
<p>Use a csv, Google sheet, or whatever else for linking sample IDs to IDs w/ this convention.</p>
<p>Other patterns (e.g., sample???) may be used (commands have a -p option for that).</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
├── Control
│   ├── sample01
│   └── sample02
└── Treatment
    ├── sample03
    └── sample04
</pre></div>
</div>
</section>
<section id="add-images-to-sample-dirs">
<h3>Add images to sample?? dirs<a class="headerlink" href="#add-images-to-sample-dirs" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>For example, image.czi, image.h5, or folder(s) with tif series</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>.
├── Control
│   ├── sample01
│   │   └── &lt;raw/stitched image(s)&gt;
│   └── sample02
│       └── &lt;raw/stitched image(s)&gt;
└── Treatment
    ├── sample03
    │   └── &lt;raw/stitched image(s)&gt;
    └── sample04
        └── &lt;raw/stitched image(s)&gt;
</pre></div>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Data can be distributed across multiple drives</p>
<p>Paths to each experiment directory may be passed into scripts using the -e flag for batch processing</p>
<p>This is useful if there is not enough storage on a single drive.</p>
<p>Also, spreading data across ~2-4 external drives allows for faster parallel processing (minimizes i/o botlenecks)</p>
<p>If SSDs are used, distrubuting data may not speed up processing as much.</p>
</div>
</section>
<section id="log-exp-paths-commands-etc">
<h3>Log exp paths, commands, etc.<a class="headerlink" href="#log-exp-paths-commands-etc" title="Link to this heading">#</a></h3>
<div class="tip dropdown admonition">
<p class="admonition-title">Make an exp_notes.txt</p>
<p>This helps with keeping track of paths, commands, etc..</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>&lt;path/exp_dir&gt;<span class="w">  </span><span class="c1"># Change the current working directory to an exp dir</span>
touch<span class="w"> </span>exp_notes.txt<span class="w">  </span><span class="c1"># Make the .txt file</span>
</pre></div>
</div>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Automatic logging of scripts</p>
<p>Most scripts log the command used to run them, appending to ./.command_log.txt.</p>
<p>This is a hidden file. Use control+h to view it on Linux or command+shift+. to view it on MacOS.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># View command history for the current working directory</span>
cat<span class="w"> </span>.command_log.txt<span class="w">  </span>

<span class="c1"># View last 10 lines</span>
cat<span class="w"> </span>.command_log.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-10<span class="w">  </span>
</pre></div>
</div>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Log commands instead of scripts</p>
</div>
</section>
<section id="make-a-sample-key-csv">
<h3>Make a sample_key.csv:<a class="headerlink" href="#make-a-sample-key-csv" title="Link to this heading">#</a></h3>
<p>It should have these columns:</p>
<ul class="simple">
<li><p>dir_name,condition</p></li>
<li><p>sample01,control</p></li>
<li><p>sample02,treatment</p></li>
<li><p>…</p></li>
</ul>
</section>
<section id="define-common-variables-in-a-shell-script">
<h3>Define common variables in a shell script<a class="headerlink" href="#define-common-variables-in-a-shell-script" title="Link to this heading">#</a></h3>
<div class="note dropdown admonition">
<p class="admonition-title">env_var.sh</p>
<ul class="simple">
<li><p>To make commands easier to run, define common variables in a shell script (e.g., env_var.sh)</p></li>
<li><p>Source the script to load variables in each terminal session</p></li>
<li><p>Copy /UNRAVEL/unravel/env_var.sh to an exp dir and update each variable</p></li>
</ul>
<p>Add this line to your .bashrc or .zshrc terminal config file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">alias</span><span class="w"> </span><span class="nv">exp</span><span class="o">=</span><span class="s2">&quot;. /path/env_var.sh&quot;</span><span class="w">  </span><span class="c1"># Update the /path/name.sh</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reopen the terminal or source the updated config file to apply changes</span>
.<span class="w"> </span>~/.zshrc

<span class="c1"># Run the alias to source the variables before using them to run commands/scripts</span>
exp
</pre></div>
</div>
</div>
</section>
<section id="optional-clean-tifs">
<h3>Optional: clean tifs<a class="headerlink" href="#optional-clean-tifs" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>If raw data is in the form of a tif series, consider running:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>utils_clean_tifs<span class="w"> </span>-t<span class="w"> </span>&lt;dir_name&gt;<span class="w"> </span>-v<span class="w"> </span>-m<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span>
</pre></div>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">utils_clean_tifs</p>
<p>This will remove spaces from files names and move files other than *.tif to the parent directory</p>
</div>
</section>
<section id="note-x-y-and-z-voxel-sizes">
<h3>Note x/y and z voxel sizes<a class="headerlink" href="#note-x-y-and-z-voxel-sizes" title="Link to this heading">#</a></h3>
<p>Extract or specify metadata (outputs to ./sample??/parameters/metadata.txt). Add the resolutions to env_var.sh.</p>
<p><a class="reference internal" href="unravel/image_io/metadata.html#module-unravel.image_io.metadata" title="unravel.image_io.metadata"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.image_io.metadata</span></code></a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>io_metadata<span class="w"> </span>-i<span class="w"> </span>&lt;rel_path/full_res_img&gt;<span class="w">  </span><span class="c1"># Glob patterns work for -i</span>
io_metadata<span class="w"> </span>-i<span class="w"> </span>&lt;tif_dir&gt;<span class="w"> </span>-x<span class="w"> </span><span class="nv">$XY</span><span class="w"> </span>-z<span class="w"> </span><span class="nv">$Z</span><span class="w">  </span><span class="c1"># Specifying x and z voxel sizes in microns</span>
</pre></div>
</div>
<br>
</section>
</section>
<hr class="docutils" />
<section id="analysis-steps">
<h2>Analysis steps<a class="headerlink" href="#analysis-steps" title="Link to this heading">#</a></h2>
<p>This section provides an overview of common commands available in UNRAVEL, ~organized by their respective steps.</p>
<section id="registration">
<h3>Registration<a class="headerlink" href="#registration" title="Link to this heading">#</a></h3>
<section id="reg-prep">
<h4><code class="docutils literal notranslate"><span class="pre">reg_prep</span></code><a class="headerlink" href="#reg-prep" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/register/reg_prep.html#module-unravel.register.reg_prep" title="unravel.register.reg_prep"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.register.reg_prep</span></code></a></p>
<ul class="simple">
<li><p>Prepare autofluo images for registration (resample to a lower resolution)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>reg_prep<span class="w"> </span>-i<span class="w"> </span>*.czi<span class="w"> </span>-x<span class="w"> </span><span class="nv">$XY</span><span class="w"> </span>-z<span class="w"> </span><span class="nv">$Z</span><span class="w"> </span>-v<span class="w">  </span><span class="c1"># -i options: tif_dir, .h5, .zarr, .tif</span>
</pre></div>
</div>
</section>
<section id="seg-copy-tifs">
<h4><code class="docutils literal notranslate"><span class="pre">seg_copy_tifs</span></code><a class="headerlink" href="#seg-copy-tifs" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/segment/copy_tifs.html#module-unravel.segment.copy_tifs" title="unravel.segment.copy_tifs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.segment.copy_tifs</span></code></a></p>
<ul class="simple">
<li><p>Copy resampled autofluo .tif files for making a brain mask with ilastik</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>seg_copy_tifs<span class="w"> </span>-i<span class="w"> </span>reg_inputs/autofl_??um_tifs<span class="w"> </span>-s<span class="w"> </span><span class="m">0000</span><span class="w"> </span><span class="m">0005</span><span class="w"> </span><span class="m">0050</span><span class="w"> </span>-o<span class="w"> </span><span class="k">$(</span>dirname<span class="w"> </span><span class="nv">$BRAIN_MASK_ILP</span><span class="k">)</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span>
</pre></div>
</div>
</section>
<section id="train-an-ilastik-project">
<h4>Train an Ilastik project<a class="headerlink" href="#train-an-ilastik-project" title="Link to this heading">#</a></h4>
<div class="note dropdown admonition">
<p class="admonition-title">Train an Ilastik project</p>
<p>Launch ilastik (e.g., by running: <code class="docutils literal notranslate"><span class="pre">ilastik</span></code> if an alias was added to the shell profile) and follow these steps:</p>
<ol class="arabic simple">
<li><p><strong>Input Data</strong><br />
Drag training slices into the ilastik GUI<br />
<code class="docutils literal notranslate"><span class="pre">ctrl+A</span></code> -&gt; right-click -&gt; Edit shared properties -&gt; Storage: Copy into project file -&gt; Ok</p></li>
<li><p><strong>Feature Selection</strong><br />
Select Features… -&gt; select all features (<code class="docutils literal notranslate"><span class="pre">control+a</span></code>) or an optimized subset (faster but less accurate)<br />
(To choose a subset of features, initially select all (<code class="docutils literal notranslate"><span class="pre">control+a</span></code>), train, turn off Live Updates, click Suggest Features, select a subset, and train again)</p></li>
<li><p><strong>Training</strong></p>
<ul class="simple">
<li><p>Double click yellow square -&gt; click yellow rectangle (Color for drawing) -&gt; click in triangle and drag to the right to change color to red -&gt; ok</p></li>
<li><p>Adjust brightness and contrast as needed (select gradient button and click and drag slowly in the image as needed; faster if zoomed in)</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">control</span></code> + mouse wheel scroll to zoom, press mouse wheel and drag image to pan</p></li>
<li><p>With label 1 selected, paint on cells</p></li>
<li><p>With label 2 selected, paint on the background</p></li>
<li><p>Turn on Live Update to preview pixel classification (faster if zoomed in) and refine training.</p>
<ul>
<li><p>If label 1 fuses neighboring cells, draw a thin line in between them with label 2.</p></li>
<li><p>Toggle eyes to show/hide layers and/or adjust transparency of layers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> will toggle segmentation on and off.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> will toggle prediction on and off.</p></li>
<li><p>If you accidentally press <code class="docutils literal notranslate"><span class="pre">a</span></code> and add an extra label, turn off Live Updates and press X next to the extra label to delete it.</p></li>
<li><p>If you want to go back to steps 1 &amp; 2, turn off Live Updates off</p></li>
</ul>
</li>
<li><p>Change Current view to see other training slices. Check segmentation for these and refine as needed.</p></li>
<li><p>Save the project in the experiment summary folder and close if using this script to run ilastik in headless mode for segmenting all images.</p></li>
</ul>
</li>
</ol>
<p><a class="reference external" href="https://www.ilastik.org/documentation/pixelclassification/pixelclassification">Pixel Classification Video</a></p>
</div>
</section>
<section id="seg-brain-mask">
<h4><code class="docutils literal notranslate"><span class="pre">seg_brain_mask</span></code><a class="headerlink" href="#seg-brain-mask" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/segment/brain_mask.html#module-unravel.segment.brain_mask" title="unravel.segment.brain_mask"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.segment.brain_mask</span></code></a></p>
<ul class="simple">
<li><p>Makes reg_inputs/autofl_??um_brain_mask.nii.gz and reg_inputs/autofl_??um_masked.nii.gz for reg</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>seg_brain_mask<span class="w"> </span>-ilp<span class="w"> </span><span class="nv">$BRAIN_MASK_ILP</span><span class="w"> </span>-v<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>seg_brain_mask zeros out voxels outside of the brain. This prevents the average template (moving image) from being pulled outward during registration (reg).</p>
<p>If non-zero voxles outside the brain remain and are affecting reg quality, use 3D slicer to zero them out by painting in 3D (segmentation module).</p>
<p>If there is missing tissue, use 3D slicer to fill in gaps.</p>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Add tutorial for 3D slicer</p>
</div>
</section>
<section id="reg">
<h4><code class="docutils literal notranslate"><span class="pre">reg</span></code><a class="headerlink" href="#reg" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/register/reg.html#module-unravel.register.reg" title="unravel.register.reg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.register.reg</span></code></a></p>
<ul class="simple">
<li><p>Register an average template brain/atlas to a resampled autofluo brain.</p></li>
</ul>
<div class="note dropdown admonition">
<p class="admonition-title">3 letter orientation code</p>
<ul class="simple">
<li><p>Letter options:</p>
<ul>
<li><p>A/P=Anterior/Posterior</p></li>
<li><p>L/R=Left/Right</p></li>
<li><p>S/I=Superior/Interior</p></li>
</ul>
</li>
<li><p>Letter order:</p>
<ul>
<li><p>The side of the brain at the positive direction of the x, y, and z axes determines the 3 letters</p></li>
<li><p>Letter 1: Side of the brain right of z-stack</p></li>
<li><p>Letter 2: Side of the brain facing bottom of z-stack</p></li>
<li><p>Letter 3: Side of the brain facing back of z-stack</p></li>
</ul>
</li>
</ul>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>reg<span class="w"> </span>-m<span class="w"> </span><span class="nv">$TEMPLATE</span><span class="w"> </span>-bc<span class="w"> </span>-pad<span class="w"> </span>-sm<span class="w"> </span><span class="m">0</span>.4<span class="w"> </span>-ort<span class="w"> </span>RPS<span class="w"> </span>-a<span class="w"> </span><span class="nv">$ATLAS</span><span class="w"> </span>-v<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span><span class="w">  </span>
</pre></div>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">If sample orientations vary</p>
<p>Make a ./sample??/parameters/ort.txt with the 3 letter orientation for each sample and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span>d<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nv">$DIRS</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$d</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>s<span class="w"> </span><span class="k">in</span><span class="w"> </span>sample??<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>reg<span class="w"> </span>-m<span class="w"> </span><span class="nv">$TEMPLATE</span><span class="w"> </span>-bc<span class="w"> </span>-pad<span class="w"> </span>-sm<span class="w"> </span><span class="m">0</span>.4<span class="w"> </span>-ort<span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span><span class="nv">$s</span>/parameters/ort.txt<span class="k">)</span><span class="w"> </span>-a<span class="w"> </span><span class="nv">$ATLAS</span><span class="w"> </span>-v<span class="w"> </span>-d<span class="w"> </span><span class="nv">$PWD</span>/<span class="nv">$s</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>We use an adapted version of a <code class="docutils literal notranslate"><span class="pre">iDISCO/LSFM-specific</span> <span class="pre">atlas</span> <span class="pre">&lt;https://pubmed.ncbi.nlm.nih.gov/33063286/&gt;</span></code>_</p></li>
</ul>
</div>
</section>
<section id="reg-check">
<h4><code class="docutils literal notranslate"><span class="pre">reg_check</span></code><a class="headerlink" href="#reg-check" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/register/reg_check.html#module-unravel.register.reg_check" title="unravel.register.reg_check"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.register.reg_check</span></code></a></p>
<ul class="simple">
<li><p>Check registration by copying these images to a target directory:</p>
<ul>
<li><p>sample??/reg_outputs/autofl_??um_masked_fixed_reg_input.nii.gz</p></li>
<li><p>sample??/reg_outputs/atlas_in_tissue_space.nii.gz</p></li>
</ul>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>reg_check<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span><span class="w"> </span>-td<span class="w"> </span><span class="nv">$BASE</span>/reg_results
</pre></div>
</div>
<ul class="simple">
<li><p>View these images with <a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FSLeyes">FSLeyes</a> <a class="reference external" href="https://open.win.ox.ac.uk/pages/fsl/fsleyes/fsleyes/userdoc/index.html">docs</a></p></li>
</ul>
<div class="note dropdown admonition">
<p class="admonition-title">Allen brain atlas coloring</p>
<ul class="simple">
<li><p>Replace /home/user/.config/fsleyes/luts/random.lut (location on Linux) with UNRAVEL/_other/fsleyes_luts/random.lut</p></li>
<li><p>Select the atlas and change “3D/4D volume” to “Label image”</p></li>
</ul>
</div>
</section>
</section>
<section id="segmentation">
<h3>Segmentation<a class="headerlink" href="#segmentation" title="Link to this heading">#</a></h3>
<p>For detailed instructions on training Ilastik, see <strong>Train an Ilastik project</strong> in the <a class="reference internal" href="#registration"><strong>Registration</strong></a> section.</p>
<section id="id3">
<h4><code class="docutils literal notranslate"><span class="pre">seg_copy_tifs</span></code><a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/segment/copy_tifs.html#module-unravel.segment.copy_tifs" title="unravel.segment.copy_tifs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.segment.copy_tifs</span></code></a></p>
<ul class="simple">
<li><p>Copy full res tif files to a target dir for training Ilastik to segment labels of interest</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Copy 3 tifs from each sample or 3 tifs from 3 samples / condition</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>seg_copy_tifs<span class="w"> </span>-i<span class="w"> </span>&lt;raw_tif_dir&gt;<span class="w"> </span>-s<span class="w"> </span><span class="m">0100</span><span class="w"> </span><span class="m">0500</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span>-o<span class="w"> </span>ilastik_segmentation<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span><span class="w"> </span>-v
</pre></div>
</div>
</section>
<section id="seg-ilastik">
<h4><code class="docutils literal notranslate"><span class="pre">seg_ilastik</span></code><a class="headerlink" href="#seg-ilastik" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/segment/ilastik_pixel_classification.html#module-unravel.segment.ilastik_pixel_classification" title="unravel.segment.ilastik_pixel_classification"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.segment.ilastik_pixel_classification</span></code></a></p>
<ul class="simple">
<li><p>Perform pixel classification using a trained Ilastik project</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>seg_ilastik<span class="w"> </span>-i<span class="w"> </span>&lt;*.czi,<span class="w"> </span>*.h5,<span class="w"> </span>or<span class="w"> </span>dir<span class="w"> </span>w/<span class="w"> </span>tifs&gt;<span class="w"> </span>-o<span class="w"> </span>seg_dir<span class="w"> </span>-ilp<span class="w"> </span><span class="nv">$BASE</span>/ilastik_segmentation/trained_ilastik_project.ilp<span class="w"> </span>-l<span class="w"> </span><span class="m">1</span><span class="w"> </span>-v<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span><span class="w"> </span>
</pre></div>
</div>
</section>
</section>
<section id="voxel-wise-stats">
<h3>Voxel-wise stats<a class="headerlink" href="#voxel-wise-stats" title="Link to this heading">#</a></h3>
<div class="note dropdown admonition">
<p class="admonition-title">Overview and steps for voxel-wise stats</p>
<ol class="arabic simple">
<li><p><strong>Create a vstats folder and subfolders for each analysis</strong>:</p>
<ul class="simple">
<li><p>Name subfolders succinctly (this name is added to other folder and file names).</p></li>
</ul>
</li>
<li><p><strong>Generate and add .nii.gz files to vstats subfolders</strong>:</p>
<ul class="simple">
<li><p>Input images are from <code class="docutils literal notranslate"><span class="pre">vstats_prep</span></code> and may have been z-scored with <code class="docutils literal notranslate"><span class="pre">vstats_z_score</span></code> (we z-score c-Fos labeling as intensities are not extreme)</p>
<ul>
<li><p>Alternatively, <code class="docutils literal notranslate"><span class="pre">warp_to_atlas</span></code> may be used is preprocessing is not desired.</p></li>
</ul>
</li>
<li><p>For bilateral data, left and right sides can be averaged with <code class="docutils literal notranslate"><span class="pre">vstats_whole_to_avg</span></code> (then use a unilateral hemisphere mask for <code class="docutils literal notranslate"><span class="pre">vstats</span></code> and <code class="docutils literal notranslate"><span class="pre">cluster_fdr</span></code>).</p></li>
<li><p>We smooth data (e.g., with a 100 µm kernel) to account for innacuracies in registration</p>
<ul>
<li><p>This can be performed with <code class="docutils literal notranslate"><span class="pre">vstats_whole_to_avg</span></code> or <code class="docutils literal notranslate"><span class="pre">vstats</span></code></p></li>
</ul>
</li>
<li><p>Prepend filenames with a one word condition (e.g., <code class="docutils literal notranslate"><span class="pre">drug_sample01_atlas_space_z.nii.gz</span></code>).</p>
<ul>
<li><p>Camel case is ok for the condition.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">utils_prepend</span></code> can add conditions to filenames.</p></li>
<li><p>Group order is alphabetical (e.g., drug is group 1 and saline is group 2).</p></li>
</ul>
</li>
<li><p>View the images in <a class="reference external" href="https://open.win.ox.ac.uk/pages/fsl/fsleyes/fsleyes/userdoc/index.html">FSLeyes</a> to ensure they are aligned and the sides are correct.</p></li>
</ul>
</li>
<li><p><strong>Determine Analysis Type</strong>:</p>
<ul class="simple">
<li><p>If there are 2 groups, <code class="docutils literal notranslate"><span class="pre">vstats</span></code> may be used after pre-processing.</p></li>
<li><p>If there are more than 2 groups, prepare for an ANOVA as described below</p></li>
</ul>
</li>
</ol>
<h4 class="rubric" id="vstats-outputs">Vstats outputs</h4>
<ul class="simple">
<li><p><strong>T-test outputs</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">vox_p_tstat1.nii.gz</span></code>: Uncorrected p-values for tstat1 (group 1 &gt; group 2).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vox_p_tstat2.nii.gz</span></code>: Uncorrected p-values for tstat2 (group 1 &lt; group 2).</p></li>
</ul>
</li>
<li><p><strong>ANOVA outputs</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">vox_p_fstat1.nii.gz</span></code>: Uncorrected p-values for fstat1 (1st contrast, e.g., drug vs. saline).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vox_p_fstat2.nii.gz</span></code>: Uncorrected p-values for fstat2 (2nd contrast, e.g., context1 vs. context2).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vox_p_fstat3.nii.gz</span></code>: Uncorrected p-values for fstat3 (3rd contrast, e.g., interaction).</p></li>
</ul>
</li>
</ul>
<h4 class="rubric" id="example-preparing-for-an-anova">Example: Preparing for an ANOVA</h4>
<ol class="arabic simple">
<li><p><strong>Setup Design Matrix</strong>:</p>
<ul class="simple">
<li><p>For an ANOVA, create <code class="docutils literal notranslate"><span class="pre">./vstats/vstats_dir/stats/design/</span></code>.</p></li>
<li><p>Open terminal from <code class="docutils literal notranslate"><span class="pre">./stats</span></code> and run: <code class="docutils literal notranslate"><span class="pre">fsl</span></code>.</p></li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">Misc</span> <span class="pre">-&gt;</span> <span class="pre">GLM</span> <span class="pre">Setup</span></code>.</p></li>
</ul>
</li>
<li><p><strong>GLM Setup Window</strong>:</p>
<ul class="simple">
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Higher-level</span> <span class="pre">/</span> <span class="pre">non-timeseries</span> <span class="pre">design</span></code>.</p></li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">inputs</span></code> to the total number of samples.</p></li>
</ul>
</li>
<li><p><strong>EVs Tab in GLM Window</strong>:</p>
<ul class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">of</span> <span class="pre">main</span> <span class="pre">EVs</span></code> to 4.</p></li>
<li><p>Name EVs (e.g., <code class="docutils literal notranslate"><span class="pre">EV1</span> <span class="pre">=</span> <span class="pre">group</span> <span class="pre">1</span></code>).</p></li>
<li><p>Set Group to 1 for all.</p></li>
</ul>
</li>
<li><p><strong>Design Matrix</strong>:</p>
<ul class="simple">
<li><p>Under <code class="docutils literal notranslate"><span class="pre">EV1</span></code>, enter 1 for each subject in group 1 (1 row/subject). EV2-4 are 0 for these rows.</p></li>
<li><p>Under <code class="docutils literal notranslate"><span class="pre">EV2</span></code>, enter 1 for each subject in group 2, starting with the row after the last row for group 1.</p></li>
<li><p>Follow this pattern for EV3 and EV4.</p></li>
</ul>
</li>
<li><p><strong>Contrasts &amp; F-tests Tab in GLM Window</strong>:</p>
<ul class="simple">
<li><p>Set <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">of</span> <span class="pre">Contrasts</span></code> to 3 for a 2x2 ANOVA:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">C1</span></code>: <code class="docutils literal notranslate"><span class="pre">Main_effect_&lt;e.g.,drug&gt;</span></code> 1 1 -1 -1 (e.g., EV1/2 are drug groups and EV3/4 are saline groups).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C2</span></code>: <code class="docutils literal notranslate"><span class="pre">Main_effect_&lt;e.g.,</span> <span class="pre">context&gt;</span></code> 1 -1 1 -1 (e.g., EV1/3 were in context1 and EV2/4 were in context2).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C3</span></code>: <code class="docutils literal notranslate"><span class="pre">Interaction</span></code> 1 -1 -1 1.</p></li>
</ul>
</li>
<li><p>Set <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">of</span> <span class="pre">F-tests</span></code> to 3:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">F1</span></code>: Click upper left box.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">F2</span></code>: Click middle box.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">F3</span></code>: Click lower right box.</p></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Finalize GLM Setup</strong>:</p>
<ul class="simple">
<li><p>In the GLM Setup window, click <code class="docutils literal notranslate"><span class="pre">Save</span></code>, then click <code class="docutils literal notranslate"><span class="pre">design</span></code>, and click <code class="docutils literal notranslate"><span class="pre">OK</span></code>.</p></li>
</ul>
</li>
<li><p><strong>Run Voxel-wise Stats</strong>:</p>
<ul class="simple">
<li><p>From the vstats_dir, run: <code class="docutils literal notranslate"><span class="pre">vstats</span></code>.</p></li>
</ul>
</li>
</ol>
<h4 class="rubric" id="background">Background</h4>
<ul class="simple">
<li><p><a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/GLM">FSL GLM Guide</a></p></li>
<li><p><a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/Randomise/UserGuide">FSL Randomise User Guide</a></p></li>
</ul>
</div>
<section id="vstats-prep">
<h4><code class="docutils literal notranslate"><span class="pre">vstats_prep</span></code><a class="headerlink" href="#vstats-prep" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/voxel_stats/vstats_prep.html#module-unravel.voxel_stats.vstats_prep" title="unravel.voxel_stats.vstats_prep"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.voxel_stats.vstats_prep</span></code></a></p>
<ul class="simple">
<li><p>Preprocess immunofluo images and warp them to atlas space for voxel-wise statistics.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vstats_prep<span class="w"> </span>-i<span class="w"> </span>cFos<span class="w"> </span>-rb<span class="w"> </span><span class="m">4</span><span class="w"> </span>-x<span class="w"> </span><span class="nv">$XY</span><span class="w"> </span>-z<span class="w"> </span><span class="nv">$Z</span><span class="w"> </span>-o<span class="w"> </span>cFos_rb4_atlas_space.nii.gz<span class="w"> </span>-v<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span>
</pre></div>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Background subtraction</p>
<p>Removing autofluorescence from immunolabeling improves the sensitivity of voxel-wise comparisons.</p>
<p>Use -s 3 for 3x3x3 spatial averaging if there is notable noise from voxel to voxel.</p>
<p>Use a smaller rolling ball radius if you want to preserve punctate signal like c-Fos+ nuclei (e.g., 4)</p>
<p>Use a larger rolling ball radius if you want to preserve more diffuse signal (e.g., 20).</p>
<p>The radius should be similar to the largest feature that you want to preserve.</p>
<p>You can test parameters for background subtraction with:</p>
<ul class="simple">
<li><p><a class="reference internal" href="unravel/image_tools/spatial_averaging.html#module-unravel.image_tools.spatial_averaging" title="unravel.image_tools.spatial_averaging"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.image_tools.spatial_averaging</span></code></a></p></li>
<li><p><a class="reference internal" href="unravel/image_tools/rb.html#module-unravel.image_tools.rb" title="unravel.image_tools.rb"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.image_tools.rb</span></code></a></p>
<ul>
<li><p>Copy a tif to a test dir for this.</p></li>
<li><p>Use <a class="reference internal" href="unravel/image_io/io_img.html#module-unravel.image_io.io_img" title="unravel.image_io.io_img"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.image_io.io_img</span></code></a> to create a tif series</p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="vstats-z-score">
<h4><code class="docutils literal notranslate"><span class="pre">vstats_z_score</span></code><a class="headerlink" href="#vstats-z-score" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/voxel_stats/z_score.html#module-unravel.voxel_stats.z_score" title="unravel.voxel_stats.z_score"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.voxel_stats.z_score</span></code></a></p>
<ul class="simple">
<li><p>Z-score atlas space images using tissue masks (from brain_mask) and/or an atlas mask.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vstats_z_score<span class="w"> </span>-i<span class="w"> </span>atlas_space/sample??_cFos_rb4_atlas_space.nii.gz<span class="w"> </span>-v<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span>
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<ul class="simple">
<li><p>atlas_space is a folder in ./sample??/ with outputs from vstats_prep</p></li>
</ul>
</div>
</section>
<section id="utils-agg-files">
<h4><code class="docutils literal notranslate"><span class="pre">utils_agg_files</span></code><a class="headerlink" href="#utils-agg-files" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/utilities/aggregate_files_from_sample_dirs.html#module-unravel.utilities.aggregate_files_from_sample_dirs" title="unravel.utilities.aggregate_files_from_sample_dirs"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.utilities.aggregate_files_from_sample_dirs</span></code></a></p>
<ul class="simple">
<li><p>Aggregate pre-processed immunofluorescence (IF) images for voxel-wise stats</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>utils_agg_files<span class="w"> </span>-i<span class="w"> </span>atlas_space/sample??_cFos_rb4_atlas_space_z.nii.gz<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span><span class="w"> </span>-v
</pre></div>
</div>
</section>
<section id="vstats-whole-to-avg">
<h4><code class="docutils literal notranslate"><span class="pre">vstats_whole_to_avg</span></code><a class="headerlink" href="#vstats-whole-to-avg" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/voxel_stats/whole_to_LR_avg.html#module-unravel.voxel_stats.whole_to_LR_avg" title="unravel.voxel_stats.whole_to_LR_avg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.voxel_stats.whole_to_LR_avg</span></code></a></p>
<ul class="simple">
<li><p>Smooth and average left and right hemispheres together</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run this in the folder with the .nii.gz images to process</span>
vstats_whole_to_avg<span class="w"> </span>-k<span class="w"> </span><span class="m">0</span>.1<span class="w"> </span>-tp<span class="w"> </span>-v<span class="w">  </span><span class="c1"># A 0.05 mm - 0.1 mm kernel radius is recommended for smoothing</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="unravel/voxel_stats/hemi_to_LR_avg.html#module-unravel.voxel_stats.hemi_to_LR_avg" title="unravel.voxel_stats.hemi_to_LR_avg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.voxel_stats.hemi_to_LR_avg</span></code></a></p>
</div>
</section>
<section id="utils-prepend">
<h4><code class="docutils literal notranslate"><span class="pre">utils_prepend</span></code><a class="headerlink" href="#utils-prepend" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/utilities/prepend_conditions.html#module-unravel.utilities.prepend_conditions" title="unravel.utilities.prepend_conditions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.utilities.prepend_conditions</span></code></a></p>
<ul class="simple">
<li><p>Prepend conditions to filenames based on a CSV w/ this organization</p>
<ul>
<li><p>dir_name,condition</p></li>
<li><p>sample01,control</p></li>
<li><p>sample02,treatment</p></li>
</ul>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>utils_prepend<span class="w"> </span>-sk<span class="w"> </span><span class="nv">$SAMPLE_KEY</span><span class="w"> </span>-f
</pre></div>
</div>
</section>
<section id="vstats">
<h4><code class="docutils literal notranslate"><span class="pre">vstats</span></code><a class="headerlink" href="#vstats" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/voxel_stats/vstats.html#module-unravel.voxel_stats.vstats" title="unravel.voxel_stats.vstats"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.voxel_stats.vstats</span></code></a></p>
<ul class="simple">
<li><p>Run voxel-wise stats using FSL’s randomise_parallel command.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vstats<span class="w"> </span>-mas<span class="w"> </span>mask.nii.gz<span class="w"> </span>-v
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Outputs in ./stats/</p>
<ul>
<li><p>vox_p maps are uncorrected 1 - p value maps</p></li>
<li><p>tstat1: group1 &gt; group2</p></li>
<li><p>tstat2: group2 &gt; group1</p></li>
<li><p>fstat*: f contrast w/ ANOVA design (non-directional p value maps)</p></li>
</ul>
</li>
</ul>
</div>
</section>
</section>
<section id="cluster-correction">
<h3>Cluster correction<a class="headerlink" href="#cluster-correction" title="Link to this heading">#</a></h3>
<p>These commands are useful for multiple comparison correction of 1 - p value maps to define clusters of significant voxels.</p>
<section id="img-avg">
<h4><code class="docutils literal notranslate"><span class="pre">img_avg</span></code><a class="headerlink" href="#img-avg" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/image_tools/avg.html#module-unravel.image_tools.avg" title="unravel.image_tools.avg"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.image_tools.avg</span></code></a></p>
<ul class="simple">
<li><p>Average *.nii.gz images</p></li>
<li><p>Visualize absolute and relative differences in intensity</p></li>
<li><p>Use averages from each group to convert non-directioanl 1 - p value maps into directional cluster indices with cluster_fdr</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>img_avg<span class="w"> </span>-i<span class="w"> </span>Control_*.nii.gz<span class="w"> </span>-o<span class="w"> </span>Control_avg.nii.gz
</pre></div>
</div>
</section>
<section id="cluster-fdr-range">
<h4><code class="docutils literal notranslate"><span class="pre">cluster_fdr_range</span></code><a class="headerlink" href="#cluster-fdr-range" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/cluster_stats/fdr_range.html#module-unravel.cluster_stats.fdr_range" title="unravel.cluster_stats.fdr_range"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.cluster_stats.fdr_range</span></code></a></p>
<ul class="simple">
<li><p>Outputs a list of FDR q values that yeild clusters.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic usage</span>
cluster_fdr_range<span class="w"> </span>-i<span class="w"> </span>vox_p_tstat1.nii.gz<span class="w"> </span>-mas<span class="w"> </span>mask.nii.gz

<span class="c1"># Perform FDR correction on multiple directional 1 - p value maps</span>
<span class="k">for</span><span class="w"> </span>j<span class="w"> </span><span class="k">in</span><span class="w"> </span>*_vox_p_*.nii.gz<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nv">q_values</span><span class="o">=</span><span class="k">$(</span>cluster_fdr_range<span class="w"> </span>-mas<span class="w"> </span><span class="nv">$MASK</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$j</span><span class="k">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>cluster_fdr<span class="w"> </span>-mas<span class="w"> </span><span class="nv">$MASK</span><span class="w"> </span>-i<span class="w"> </span><span class="nv">$j</span><span class="w"> </span>-q<span class="w"> </span><span class="nv">$q_values</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">done</span>

<span class="c1"># Convert a non-directioanl 1 - p value map into a directional cluster index</span>
<span class="nv">q_values</span><span class="o">=</span><span class="k">$(</span>cluster_fdr_range<span class="w"> </span>-i<span class="w"> </span>vox_p_fstat1.nii.gz<span class="w"> </span>-mas<span class="w"> </span><span class="nv">$MASK</span><span class="k">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span>cluster_fdr<span class="w"> </span>-i<span class="w"> </span>vox_p_fstat1.nii.gz<span class="w"> </span>-mas<span class="w"> </span><span class="nv">$MASK</span><span class="w"> </span>-o<span class="w"> </span>fstat1<span class="w"> </span>-v<span class="w"> </span>-a1<span class="w"> </span>Control_avg.nii.gz<span class="w"> </span>-a2<span class="w"> </span>Deep_avg.nii.gz<span class="w"> </span>-q<span class="w"> </span><span class="nv">$q_values</span>
</pre></div>
</div>
</section>
<section id="cluster-fdr">
<h4><code class="docutils literal notranslate"><span class="pre">cluster_fdr</span></code><a class="headerlink" href="#cluster-fdr" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/cluster_stats/fdr.html#module-unravel.cluster_stats.fdr" title="unravel.cluster_stats.fdr"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.cluster_stats.fdr</span></code></a></p>
<ul class="simple">
<li><p>Perform FDR correction on a 1 - p value map to define clusters</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cluster_fdr<span class="w"> </span>-i<span class="w"> </span>vox_p_tstat1.nii.gz<span class="w"> </span>-mas<span class="w"> </span>mask.nii.gz<span class="w"> </span>-q<span class="w"> </span><span class="m">0</span>.05
</pre></div>
</div>
</section>
<section id="cluster-mirror-indices">
<h4><code class="docutils literal notranslate"><span class="pre">cluster_mirror_indices</span></code><a class="headerlink" href="#cluster-mirror-indices" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/cluster_stats/recursively_mirror_rev_cluster_indices.html#module-unravel.cluster_stats.recursively_mirror_rev_cluster_indices" title="unravel.cluster_stats.recursively_mirror_rev_cluster_indices"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.cluster_stats.recursively_mirror_rev_cluster_indices</span></code></a></p>
<ul class="simple">
<li><p>Recursively flip the content of rev_cluster_index.nii.gz images</p></li>
<li><p>Run this in the ./stats/ folder to process all subdirs with reverse cluster maps (cluster IDs go from large to small)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use -m RH if a right hemisphere mask was used (otherwise use -m LH)</span>
cluster_mirror_indices<span class="w"> </span>-m<span class="w"> </span>RH<span class="w"> </span>-v
</pre></div>
</div>
</section>
</section>
<section id="cluster-validation">
<h3>Cluster validation<a class="headerlink" href="#cluster-validation" title="Link to this heading">#</a></h3>
<section id="id4">
<h4><code class="docutils literal notranslate"><span class="pre">cluster_validation</span></code><a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/cluster_stats/cluster_validation.html#module-unravel.cluster_stats.cluster_validation" title="unravel.cluster_stats.cluster_validation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.cluster_stats.cluster_validation</span></code></a></p>
<ul class="simple">
<li><p>Warps cluster index from atlas space to tissue space, crops clusters, applies segmentation mask, and quantifies cell/object or    label densities</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basic usage:</span>
cluster_validation<span class="w"> </span>-e<span class="w"> </span>&lt;experiment<span class="w"> </span>paths&gt;<span class="w"> </span>-m<span class="w"> </span>&lt;path/rev_cluster_index_to_warp_from_atlas_space.nii.gz&gt;<span class="w"> </span>-s<span class="w"> </span>seg_dir<span class="w"> </span>-v

<span class="c1"># Processing multiple FDR q value thresholds and both hemispheres:</span>
<span class="k">for</span><span class="w"> </span>q<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.005<span class="w"> </span><span class="m">0</span>.01<span class="w"> </span><span class="m">0</span>.05<span class="w"> </span><span class="m">0</span>.1<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>side<span class="w"> </span><span class="k">in</span><span class="w"> </span>LH<span class="w"> </span>RH<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>cluster_validation<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span><span class="w"> </span>-m<span class="w"> </span>path/vstats/contrast/stats/contrast_vox_p_tstat1_q<span class="si">${</span><span class="nv">q</span><span class="si">}</span>/contrast_vox_p_tstat1_q<span class="si">${</span><span class="nv">q</span><span class="si">}</span>_rev_cluster_index_<span class="si">${</span><span class="nv">side</span><span class="si">}</span>.nii.gz<span class="w"> </span>-s<span class="w"> </span>seg_dir/sample??_seg_dir_1.nii.gz<span class="w"> </span>-v<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="k">done</span>
</pre></div>
</div>
</section>
<section id="cluster-summary">
<h4><code class="docutils literal notranslate"><span class="pre">cluster_summary</span></code><a class="headerlink" href="#cluster-summary" title="Link to this heading">#</a></h4>
<p><a class="reference internal" href="unravel/cluster_stats/cluster_summary.html#module-unravel.cluster_stats.cluster_summary" title="unravel.cluster_stats.cluster_summary"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.cluster_stats.cluster_summary</span></code></a></p>
<ul class="simple">
<li><p>Aggregates and analyzes cluster validation data from <code class="docutils literal notranslate"><span class="pre">cluster_validation</span></code></p></li>
<li><p>Update parameters in /UNRAVEL/unravel/cluster_stats/cluster_summary.ini and save it with the experiment</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cluster_summary<span class="w"> </span>-c<span class="w"> </span>path/cluster_summary.ini<span class="w"> </span>-e<span class="w"> </span><span class="nv">$DIRS</span><span class="w"> </span>-cvd<span class="w"> </span><span class="s1">&#39;*&#39;</span><span class="w"> </span>-vd<span class="w"> </span>path/vstats_dir<span class="w"> </span>-sk<span class="w"> </span><span class="nv">$SAMPLE_KEY</span><span class="w"> </span>--groups<span class="w"> </span>group1<span class="w"> </span>group2<span class="w"> </span>-v
</pre></div>
</div>
<p>group1 and group2 must match conditions in the sample_key.csv</p>
</section>
</section>
<section id="region-wise-stats">
<h3>Region-wise stats<a class="headerlink" href="#region-wise-stats" title="Link to this heading">#</a></h3>
<section id="rstats">
<h4><code class="docutils literal notranslate"><span class="pre">rstats</span></code><a class="headerlink" href="#rstats" title="Link to this heading">#</a></h4>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.region_stats.regional_cell_densities</span></code></p>
<ul class="simple">
<li><p>Perform regional cell counting (label density measurements needs to be added)</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use if atlas is already in native space from warp_to_native</span>
rstats<span class="w"> </span>-s<span class="w"> </span>rel_path/segmentation_image.nii.gz<span class="w"> </span>-a<span class="w"> </span>rel_path/native_atlas_split.nii.gz<span class="w"> </span>-c<span class="w"> </span>Saline<span class="w"> </span>--dirs<span class="w"> </span>sample14<span class="w"> </span>sample36

<span class="c1"># Use if native atlas is not available; it is not saved (faster)</span>
rstats<span class="w"> </span>-s<span class="w"> </span>rel_path/segmentation_image.nii.gz<span class="w"> </span>-m<span class="w"> </span>path/atlas_split.nii.gz<span class="w"> </span>-c<span class="w"> </span>Saline<span class="w"> </span>--dirs<span class="w"> </span>sample14<span class="w"> </span>sample36
</pre></div>
</div>
</section>
<section id="rstats-summary">
<h4><code class="docutils literal notranslate"><span class="pre">rstats_summary</span></code><a class="headerlink" href="#rstats-summary" title="Link to this heading">#</a></h4>
<p><code class="xref py py-mod docutils literal notranslate"><span class="pre">unravel.region_stats.regional_cell_densities_summary</span></code></p>
<ul class="simple">
<li><p>Plot cell densities for each region and summarize results.</p></li>
<li><p>CSV columns:</p>
<ul>
<li><p>Region_ID,Side,Name,Abbr,Saline_sample06,Saline_sample07,…,MDMA_sample01,…,Meth_sample23,…</p></li>
</ul>
</li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rstats_summary<span class="w"> </span>--groups<span class="w"> </span>Saline<span class="w"> </span>MDMA<span class="w"> </span>Meth<span class="w"> </span>-d<span class="w"> </span><span class="m">10000</span><span class="w"> </span>-hemi<span class="w"> </span>r
</pre></div>
</div>
</section>
</section>
<section id="example-sample-folder-structure-after-analysis">
<h3>Example sample?? folder structure after analysis<a class="headerlink" href="#example-sample-folder-structure-after-analysis" title="Link to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.
├──<span class="w"> </span>atlas_space<span class="w">  </span><span class="c1"># Dir with images warped to atlas space</span>
├──<span class="w"> </span>cfos_seg_ilastik_1<span class="w">  </span><span class="c1"># Example dir with segmentations from ilastik</span>
├──<span class="w"> </span>clusters<span class="w">  </span><span class="c1"># Dir with cell/label density CSVs from cluster_validation</span>
│<span class="w">   </span>├──<span class="w"> </span>Control_v_Treatment_vox_p_tstat1_q0.005
│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>cell_density_data.csv
│<span class="w">   </span>└──<span class="w"> </span>Control_v_Treatment_vox_p_tstat2_q0.05
│<span class="w">       </span>└──<span class="w"> </span>cell_density_data.csv
├──<span class="w"> </span>parameters<span class="w">  </span><span class="c1"># Optional dir for things like metadata.txt</span>
├──<span class="w"> </span>reg_inputs<span class="w">  </span><span class="c1"># From reg_prep (autofl image resampled for reg) and seg_brain_mask (mask, masked autofl)</span>
├──<span class="w"> </span>regional_cell_densities<span class="w">  </span><span class="c1"># CSVs with regional cell densities data</span>
├──<span class="w"> </span>reg_outputs<span class="w">  </span><span class="c1"># Outputs from reg. These images are typically padded w/ empty voxels. </span>
└──<span class="w"> </span>image.czi<span class="w"> </span><span class="c1"># Or other raw/stitched image type</span>
</pre></div>
</div>
</section>
<section id="example-experiment-folder-structure-after-analysis">
<h3>Example experiment folder structure after analysis<a class="headerlink" href="#example-experiment-folder-structure-after-analysis" title="Link to this heading">#</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.
├──<span class="w"> </span>exp_notes.txt
├──<span class="w"> </span>env_var.sh
├──<span class="w"> </span>sample_key.csv
├──<span class="w"> </span>Control
│<span class="w">   </span>├──<span class="w"> </span>sample01
│<span class="w">   </span>└──<span class="w"> </span>sample02
├──<span class="w"> </span>Treatment
│<span class="w">   </span>├──<span class="w"> </span>sample03
│<span class="w">   </span>└──<span class="w"> </span>sample04
├──<span class="w"> </span>atlas
│<span class="w">   </span>├──<span class="w"> </span>gubra_ano_25um_bin.nii.gz<span class="w">  </span><span class="c1"># bin indicates that this has been binarized (background = 0; foreground = 1)</span>
│<span class="w">   </span>├──<span class="w"> </span>gubra_ano_combined_25um.nii.gz<span class="w">  </span><span class="c1"># Each atlas region has a unique intensity/ID</span>
│<span class="w">   </span>├──<span class="w"> </span>gubra_ano_split_25um.nii.gz<span class="w">  </span><span class="c1"># Intensities in the left hemisphere are increased by 20,000</span>
│<span class="w">   </span>├──<span class="w"> </span>gubra_mask_25um_wo_ventricles_root_fibers_LH.nii.gz<span class="w">  </span><span class="c1"># Left hemisphere mask that excludes ventricles, undefined regions (root), and fiber tracts</span>
│<span class="w">   </span>├──<span class="w"> </span>gubra_mask_25um_wo_ventricles_root_fibers_RH.nii.gz
│<span class="w">   </span>└──<span class="w"> </span>gubra_template_25um.nii.gz<span class="w">  </span><span class="c1"># Average template brain that is aligned with the atlas</span>
├──<span class="w"> </span>reg_results
├──<span class="w"> </span>ilastik_brain_mask
│<span class="w">   </span>├──<span class="w"> </span>brain_mask.ilp<span class="w">  </span><span class="c1"># Ilastik project trained with the pixel classification workflow to segment the brain in resampled autofluo images</span>
│<span class="w">   </span>├──<span class="w"> </span>sample01_slice_0000.tif
│<span class="w">   </span>├──<span class="w"> </span>sample01_slice_0005.tif
│<span class="w">   </span>├──<span class="w"> </span>sample01_slice_0050.tif
│<span class="w">   </span>├──<span class="w"> </span>...
│<span class="w">   </span>└──<span class="w"> </span>sample04_slice_0050.tif
├──<span class="w"> </span>vstats
│<span class="w">   </span>└──<span class="w"> </span>Control_v_Treatment<span class="w"> </span>
│<span class="w">       </span>├──<span class="w"> </span>Control_sample01_rb4_atlas_space_z.tif
│<span class="w">       </span>├──<span class="w"> </span>Control_sample02_rb4_atlas_space_z.tif
│<span class="w">       </span>├──<span class="w"> </span>Treatment_sample03_rb4_atlas_space_z.tif
│<span class="w">       </span>├──<span class="w"> </span>Treatment_sample04_rb4_atlas_space_z.tif
│<span class="w">       </span>└──<span class="w"> </span>stats<span class="w"> </span>
│<span class="w">           </span>├──<span class="w"> </span>Control_v_Treatment_vox_p_tstat1.nii.gz<span class="w">  </span><span class="c1"># 1 minus p value map showing where Control (group 1) &gt; Treatment (group2)</span>
│<span class="w">           </span>├──<span class="w"> </span>Control_v_Treatment_vox_p_tstat2.nii.gz<span class="w">  </span><span class="c1"># 1 - p value map showing where Treatment (group 2) &gt; Control (group 1)</span>
│<span class="w">           </span>├──<span class="w"> </span>Control_v_Treatment_vox_p_tstat1_q0.005<span class="w">  </span><span class="c1"># cluster correction folder</span>
│<span class="w">           </span>│<span class="w">   </span>├──<span class="w"> </span><span class="m">1</span>-p_value_threshold.txt<span class="w">  </span><span class="c1"># FDR adjusted 1 - p value threshold for the uncorrected 1 - p value map</span>
│<span class="w">           </span>│<span class="w">   </span>├──<span class="w"> </span>p_value_threshold.txt<span class="w">  </span><span class="c1"># FDR adjusted p value threshold</span>
│<span class="w">           </span>│<span class="w">   </span>├──<span class="w"> </span>min_cluster_size_in_voxels.txt<span class="w">  </span><span class="c1"># Often 100 voxels for c-Fos. For sparser signals like amyloid beta plaques, consider 400 or more</span>
│<span class="w">           </span>│<span class="w">   </span>└──<span class="w"> </span>..._rev_cluster_index.nii.gz<span class="w"> </span><span class="c1"># cluster map (index) with cluster IDs going from large to small (input for cluster_validation)</span>
│<span class="w">           </span>├──<span class="w"> </span>...
│<span class="w">           </span>└──<span class="w"> </span>Control_v_Treatment_vox_p_tstat2_q0.05
├──<span class="w"> </span>cluster_validation
│<span class="w">   </span>├──<span class="w"> </span>Control_v_Treatment_vox_p_tstat1_q0.005
│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>Control_sample01_cell_density_data.csv
│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>Control_sample02_cell_density_data.csv
│<span class="w">   </span>│<span class="w">   </span>├──<span class="w"> </span>Treatment_sample03_cell_density_data.csv
│<span class="w">   </span>│<span class="w">   </span>└──<span class="w"> </span>Treatment_sample04_cell_density_data.csv
│<span class="w">   </span>├──<span class="w"> </span>...
│<span class="w">   </span>└──<span class="w"> </span>Control_v_Treatment_vox_p_tstat2_q0.05
└──<span class="w"> </span>regional_cell_densities
<span class="w">    </span>├──<span class="w"> </span>Control_sample01_regional_cell_densities.csv
<span class="w">    </span>├──<span class="w"> </span>...
<span class="w">    </span>└──<span class="w"> </span>Treatment_sample04_regional_cell_densities.csv
</pre></div>
</div>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p>Add notes here on ploting sunbursts and viewing clusters in 3D. Prompt us when you get to this step (notes on Slack)</p>
<p>Also show the structure of data from cluster_validation and rstats_summary</p>
<p>Add support for CCFv3 2020</p>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="unravel/toc.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">unravel package</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#typical-workflow">Typical workflow</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#help-on-commands">Help on commands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#listing-commands">Listing commands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-commands">Common commands</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up">Set up</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#back-up-raw-data">Back up raw data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stitch-z-stacks">Stitch z-stacks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-sample-folders">Make sample folders</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-images-to-sample-dirs">Add images to sample?? dirs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-exp-paths-commands-etc">Log exp paths, commands, etc.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-a-sample-key-csv">Make a sample_key.csv:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-common-variables-in-a-shell-script">Define common variables in a shell script</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optional-clean-tifs">Optional: clean tifs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#note-x-y-and-z-voxel-sizes">Note x/y and z voxel sizes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-steps">Analysis steps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#registration">Registration</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reg-prep"><code class="docutils literal notranslate"><span class="pre">reg_prep</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seg-copy-tifs"><code class="docutils literal notranslate"><span class="pre">seg_copy_tifs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#train-an-ilastik-project">Train an Ilastik project</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seg-brain-mask"><code class="docutils literal notranslate"><span class="pre">seg_brain_mask</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reg"><code class="docutils literal notranslate"><span class="pre">reg</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reg-check"><code class="docutils literal notranslate"><span class="pre">reg_check</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#segmentation">Segmentation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><code class="docutils literal notranslate"><span class="pre">seg_copy_tifs</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#seg-ilastik"><code class="docutils literal notranslate"><span class="pre">seg_ilastik</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#voxel-wise-stats">Voxel-wise stats</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vstats-prep"><code class="docutils literal notranslate"><span class="pre">vstats_prep</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vstats-z-score"><code class="docutils literal notranslate"><span class="pre">vstats_z_score</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#utils-agg-files"><code class="docutils literal notranslate"><span class="pre">utils_agg_files</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vstats-whole-to-avg"><code class="docutils literal notranslate"><span class="pre">vstats_whole_to_avg</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#utils-prepend"><code class="docutils literal notranslate"><span class="pre">utils_prepend</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vstats"><code class="docutils literal notranslate"><span class="pre">vstats</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-correction">Cluster correction</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#img-avg"><code class="docutils literal notranslate"><span class="pre">img_avg</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-fdr-range"><code class="docutils literal notranslate"><span class="pre">cluster_fdr_range</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-fdr"><code class="docutils literal notranslate"><span class="pre">cluster_fdr</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-mirror-indices"><code class="docutils literal notranslate"><span class="pre">cluster_mirror_indices</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-validation">Cluster validation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><code class="docutils literal notranslate"><span class="pre">cluster_validation</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cluster-summary"><code class="docutils literal notranslate"><span class="pre">cluster_summary</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#region-wise-stats">Region-wise stats</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rstats"><code class="docutils literal notranslate"><span class="pre">rstats</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rstats-summary"><code class="docutils literal notranslate"><span class="pre">rstats_summary</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-sample-folder-structure-after-analysis">Example sample?? folder structure after analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-experiment-folder-structure-after-analysis">Example experiment folder structure after analysis</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/guide.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, the UNRAVEL team.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>